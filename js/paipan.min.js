"use strict";function paipan(){this.J=120;this.W=35;this.JQ=new Array();this.zwz=true;this.synmonth=29.530588853;this.debug=true;this.wkd=["日","一","二","三","四","五","六"];this.gz=["甲子","乙丑","丙寅","丁卯","戊辰","己巳","庚午","辛未","壬申","癸酉","甲戌","乙亥","丙子","丁丑","戊寅","己卯","庚辰","辛巳","壬午","癸未","甲申","乙酉","丙戌","丁亥","戊子","己丑","庚寅","辛卯","壬辰","癸巳","甲午","乙未","丙申","丁酉","戊戌","己亥","庚子","辛丑","壬寅","癸卯","甲辰","乙巳","丙午","丁未","戊申","己酉","庚戌","辛亥","壬子","癸丑","甲寅","乙卯","丙辰","丁巳","戊午","己未","庚申","辛酉","壬戌","癸亥"];this.ctg=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"];this.cdz=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"];this.csx=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"];this.jq=["春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至","小寒","大寒","立春","雨水","惊蛰"];this.dxy=["正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","冬月","腊月"];this.dxd=["初一","初二","初三","初四","初五","初六","初七","初八","初九","初十","十一","十二","十三","十四","十五","十六","十七","十八","十九","廿十","廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十"];this.dxs=["零","一","二","三","四","五","六","七","八","九"];this.cwx=["金","水","木","火","土"];this.xb=["男","女"];this.mz=["乾","坤"];this.cyy=["阳","阴"];this.wxtg=[2,2,3,3,4,4,0,0,1,1];this.wxdz=[1,4,2,2,4,3,3,4,0,0,4,1];this.ssq=["正印","偏印","比肩","劫財","傷官","食神","正財","偏財","正官","偏官"];this.sss=["印","卩","比","劫","伤","食","财","才","官","杀"];this.dgs=[[2,3,1,0,9,8,7,6,5,4],[3,2,0,1,8,9,6,7,4,5],[5,4,2,3,1,0,9,8,7,6],[4,5,3,2,0,1,8,9,6,7],[7,6,5,4,2,3,1,0,9,8],[6,7,4,5,3,2,0,1,8,9],[9,8,7,6,5,4,2,3,1,0],[8,9,6,7,4,5,3,2,0,1],[1,0,9,8,7,6,5,4,2,3],[0,1,8,9,6,7,4,5,3,2]];this.dzs=[[0,1,8,9,6,7,4,5,3,2],[6,7,4,5,3,2,0,1,8,9],[2,3,1,0,9,8,7,6,5,4],[3,2,0,1,8,9,6,7,4,5],[7,6,5,4,2,3,1,0,9,8],[5,4,2,3,1,0,9,8,7,6],[4,5,3,2,0,1,8,9,6,7],[6,7,4,5,3,2,0,1,8,9],[9,8,7,6,5,4,2,3,1,0],[8,9,6,7,4,5,3,2,0,1],[7,6,5,4,2,3,1,0,9,8],[1,0,9,8,7,6,5,4,2,3]];this.cxz=["摩羯","水瓶","双鱼","白羊","金牛","双子","巨蟹","狮子","处女","天秤","天蝎","射手"];this.zcg=[[9,-1,-1],[5,9,7],[0,2,4],[1,-1,-1],[4,1,9],[2,4,6],[3,5,-1],[5,1,3],[6,8,4],[7,-1,-1],[4,7,3],[8,0,-1]];this.czs=["長生(強)","沐浴(凶)","冠帶(吉)","臨官(大吉)","帝旺(大吉)","衰(弱)","病(弱)","死(凶)","墓(吉)","絕(凶)","胎(平)","養(平)"];this.yyss=["異","同"];this.sxss=["生我","同我","我生","我克","克我"];this.cfw=["　中　","　北　","北北東","東北東","　東　","東南東","南南東","　南　","南南西","西南西","　西　","西北西","北北西"];this.csj=["旺四季","　春　","　夏　","　秋　","　冬　"];this.fwtg=[4,4,7,7,0,0,10,10,1,1];this.fwdz=[1,2,3,4,5,6,7,8,9,10,11,12];this.sjtg=[1,1,2,2,0,0,3,3,4,4];this.sjdz=[1,1,2,2,2,3,3,3,4,4,4,1];this.jqXFu={1646:{1:-1,9:1,22:-1,23:-1},1647:{0:-1},1650:{1:-1,9:1,11:1,22:-1},1651:{0:-1,3:-1},1652:{11:-1},1653:{2:-1},1654:{0:-1,1:-1,11:1,17:-1},1655:{0:-1,3:-1,20:1},1656:{10:1,13:1},1657:{2:-1,8:1,20:-1},1658:{5:-1,11:1,21:-1},1659:{3:-1,6:-1},1660:{7:1,10:1,13:1,15:1},1661:{2:-1,12:1,20:-1},1662:{5:-1,11:1,21:-1},1663:{3:-1,23:-1},1664:{10:1,13:1,15:1,19:-1},1665:{2:-1,4:-1,12:1,20:-1},1666:{21:-1},1667:{22:-1,23:-1},1668:{14:1,19:-1},1669:{4:-1,12:1},1670:{21:-1},1671:{1:-1,18:-1,22:-1,23:-1},1672:{0:-1,14:1},1673:{12:1,16:1},1675:{1:-1,9:1,22:-1,23:-1},1676:{0:-1,14:1},1677:{16:1},1678:{4:-1},1679:{1:-1,4:-1,9:1,22:-1,23:-1},1680:{0:-1,3:-1},1682:{2:-1},1683:{1:-1,11:1,22:-1},1684:{0:-1,3:-1},1685:{10:1},1686:{2:-1,8:1},1687:{1:-1,5:-1,11:1},1688:{0:-1,3:-1,6:-1},1689:{10:1,13:1},1690:{2:-1,20:-1},1691:{5:-1,11:1,21:-1},1692:{3:-1,21:1},1693:{10:1,13:1,15:1},1694:{2:-1,4:-1,12:1,20:-1},1695:{21:-1},1696:{23:-1},1697:{13:1,15:1,19:-1},1698:{2:-1,4:-1,12:1,20:-1},1699:{21:-1},1700:{1:-1,23:-1},1701:{15:1,19:-1},1702:{4:-1,12:1,20:-1},1703:{21:-1},1704:{1:-1,9:1,22:-1,23:-1},1705:{0:-1,14:1},1708:{1:-1,9:1,18:-1,22:-1,23:-1},1709:{0:-1},1710:{16:1},1712:{1:-1,11:1,22:-1,23:-1},1713:{0:-1,3:-1},1714:{10:1},1715:{2:-1,8:1},1716:{1:-1,5:-1,11:1,22:-1},1717:{0:-1,3:-1,6:-1},1718:{10:1},1719:{2:-1},1720:{5:-1,11:1},1721:{0:-1,3:-1},1722:{10:1,13:1},1723:{2:-1,4:-1},1724:{21:-1},1725:{3:-1},1726:{13:1,15:1},1727:{2:-1,4:-1,12:1,20:-1},1728:{21:-1},1729:{23:-1},1730:{13:1,14:1,15:1},1731:{4:-1,12:1,20:-1},1732:{21:-1},1733:{1:-1},1735:{20:-1},1738:{19:-1},1740:{21:-1},1744:{8:-1},1745:{23:-1},1747:{7:-1},1749:{1:-1},1751:{13:1},1753:{5:-1,22:-1},1756:{12:1},1760:{2:-1},1773:{21:-1},1774:{11:1},1776:{16:1},1778:{23:-1},1779:{6:-1},1781:{17:1},1782:{1:-1},1784:{13:1},1786:{22:-1},1806:{21:-1},1808:{19:-1},1809:{16:1},1811:{23:-1},1815:{1:-1},1817:{13:1},1819:{22:-1},1824:{9:1},1826:{4:-1},1829:{15:1},1836:{11:1},1844:{5:1},1846:{16:1},1848:{18:1},1849:{3:-1},1850:{13:1},1851:{12:1,17:1},1855:{2:-1},1862:{14:1,15:1},1864:{8:1},1866:{14:1},1867:{7:1,10:1},1878:{19:1},1879:{16:1},1883:{13:1},1884:{12:1,17:1},1886:{9:1},1895:{14:1,15:1},1898:{11:1},1899:{6:1,14:1},1912:{16:1},1913:{12:1},1917:{17:-1},1922:{22:-1},1927:{11:-1},1928:{6:-1},1951:{18:1},1978:{20:-1},2295:{5:1}};this.smXFu={1649:{5:-1},1662:{2:-1},1673:{11:1},1684:{14:-1},1685:{2:-1},1687:{3:-1},1694:{7:-1},1704:{11:1},1708:{3:-1},1720:{7:-1},1759:{4:-1},1778:{4:-1},1779:{7:-1},1787:{12:-1},1788:{0:-1},1789:{8:-1},1796:{6:-1},1804:{8:-1},1831:{4:-1},1841:{14:-1},1842:{1:-1},1862:{14:-1},1863:{1:-1},1880:{11:1},1896:{2:-1},1914:{12:-1},1915:{14:-1},1916:{2:-1},1920:{11:-1}};this.logs=function(d,c){var a=new Array();a[0]="超出計算能力";a[1]="適用於西元-1000年至西元3000年,超出此範圍誤差較大";a[2]="对应的干支不存在";a[3]="干支非六十甲子";a[4]="日期超出範圍";a[5]="日期錯誤";a[6]="月份錯誤";a[7]="此年非閏年";a[8]="此月非閏月";a[9]="不存在的时间";a[10]="参数非整数字符串";a[11]="参数非整数类型";a[12]="参数非浮点类型";a[13]="月份超出範圍";a[14]="此年無閏月";a[15]="参数非整数";a[16]="参数非数字";if(this.debug){var b=(a[d]===undefined)?d:a[d];b+=(c===undefined)?"":(":"+c);console.log(b)}return false};this.intval=function(b,e){var c,a;var d=typeof b;if(d==="boolean"){return +b}else{if(d==="string"){if(e===0){a=b.match(/^\s*0(x?)/i);e=a?(a[1]?16:8):10}c=parseInt(b,e||10);if(isNaN(c)||!isFinite(c)){this.logs(15,c);return 0}return c}else{if(d==="number"&&isFinite(b)){return b<0?Math.ceil(b):Math.floor(b)}else{this.logs(15,b);return 0}}}};this.floatval=function(a){var b=parseFloat(a);if(isNaN(b)){this.logs(16,a)}return(b||0)};this.boolval=function(a){if(a===false){return false}if(a===0||a===0){return false}if(a===""||a==="0"){return false}if(Array.isArray(a)&&a.length===0){return false}if(a===null||a===undefined){return false}return true};this.cn=function(a){return Math.cos(a*0.0174532925199433)};this.sn=function(a){return Math.sin(a*0.0174532925199433)};this.fpart=function(a){a=a-Math.floor(a);if(a<0){a=a+1}return a};this.ipart=function(a){return(a/Math.abs(a))*Math.floor(Math.abs(a))};this.quad=function(d,p,a){var l=0;var e=0.5*(d+a)-p;var o=0.5*(a-d);var n=p;var q=-o/(2*e);var m=(e*q+o)*q+n;var f=o*o-4*e*n;if(f>0){var r=0.5*Math.sqrt(f)/Math.abs(e);var h=q-r;var g=q+r;if(Math.abs(h)<=1){l=l+1}if(Math.abs(g)<=1){l=l+1}if(h<-1){h=g}}return Array(q,m,h,g,l)};this.sinalt=function(e,s,f){var z=(e-51544.5)/36525;var b=2*Math.PI;var h=0.91748;var n=0.39778;var B=b*this.fpart(0.993133+99.997361*z);var r=6893*Math.sin(B)+72*Math.sin(2*B);var p=b*this.fpart(0.7859453+B/b+(6191.2*z+r)/1296000);var E=Math.sin(p);var v=Math.cos(p);var u=h*E;var c=n*E;var d=Math.sqrt(1-c*c);var A=(360/b)*Math.atan(c/d);var D=(48/b)*Math.atan(u/(v+d));if(D<0){D=D+24}var g=this.ipart(e);var o=(e-g)*24;var q=(g-51544.5)/36525;var l=6.697374558+1.0027379093*o;l=l+(8640184.812866+(0.093104-0.0000062*q)*q)*q/3600;var a=24*this.fpart((l-s/15)/24);var C=15*(a-D);var w=this.sn(-50/60);return this.sn(f)*this.sn(A)+this.cn(f)*this.cn(A)*this.cn(C)-w};this.zty=function(u,m,g){var u=this.floatval(u);var m=(m===undefined)?-1*this.J:-1*this.floatval(m);var g=(g===undefined)?+1*this.W:+1*this.floatval(g);var n=Math.round(u)-2400001-this.J/360;var d=0;var b=0;var a=0;var v=0;var l=1;var f=0;var t=this.sinalt(n+(l-1)/24,m,g);var s=(t>0)?1:0;do{var h=this.sinalt(n+(l+0)/24,m,g);var q=this.sinalt(n+(l+1)/24,m,g);var [xe,c,p,o,r]=this.quad(t,h,q);switch(r){case 0:break;case 1:if(t<0){d=1;b=l+p}else{a=1;v=l+p}break;case 2:if(c<0){b=l+o;v=l+p}else{b=l+p;v=l+o}d=1;a=1;f=1;break}t=q;l=l+2}while((l<25)&&(d*a==0));if(d*a==0){return u}while(v<b){v+=24}var noon=b+(v-b)/2;return u-(noon-12)/24};this.Jdays=function(C,A,F,z,x,J){var C=this.floatval(C);var A=this.floatval(A);var F=this.floatval(F);var z=this.floatval(z);var x=(x===undefined)?0:this.floatval(x);var J=(J===undefined)?0:this.floatval(J);if(C<-7000||C>7000){this.logs(0);return false}var w=C+Math.floor((A-3)/10);if((C>1582)||(C==1582&&A>10)||(C==1582&&A==10&&F>=15)){var H=1721119.5;var I=Math.floor(w*365.25)-Math.floor(w/100)+Math.floor(w/400)}else{if((C<1582)||(C==1582&&A<10)||(C==1582&&A==10&&F<=4)){var H=1721117.5;var I=Math.floor(w*365.25)}else{this.logs(9);return false}}var y=Math.floor(A+9)%12;var B=y*30+Math.floor((y+1)*34/57);var G=F-1;z=z+((J/60)+x)/60;var D=z/24;var E=I+B+G+D+H;return E};this.Jtime=function(Q){var Q=this.floatval(Q);if(Q>=2299160.5){var C=146097;var J=1721119.5}else{var C=146100;var J=1721117.5}var A=Math.floor(Q-J);var R=C/4;var L=Math.floor((A+0.75)/R);var N=Math.floor(A+0.75-L*R);var x=1461/4;var D=Math.floor((N+0.75)/x);N=Math.floor(N+0.75-x*D+1);var M=153/5;var I=Math.floor((N-0.5)/M);N=Math.floor((N-0.5)-30.6*I+1);var B=(100*L)+D;var G=(I+2)%12+1;if(G<3){B=B+1}var w=Math.floor((Q+0.5-Math.floor(Q+0.5))*24*60*60+0.00005);var F=Math.floor(w/60);var H=w%60;var z=Math.floor(F/60);var P=F%60;var E=Math.floor(B);var K=Math.floor(G);var O=Math.floor(N);return Array(E,K,O,z,P,H)};this.ValidDate=function(D,C,w){var x=true;if(C<=0||C>12){this.logs(13);x=false}else{var z=-(D%4==0);var y=((D%400==0)-(D%100==0))&&(D>1582);var B=z+y;var A=30+((Math.abs(C-7.5)+0.5)%2)-(C==2)*(2+B);if(w<=0||w>A){if(B==0&&C==2&&w==29){this.logs(14)}else{this.logs(4)}x=false}}if(D==1582&&C==10&&w>=5&&w<15){this.logs(9);x=false}return x};this.VE=function(z){var x=this.intval(z);if(x>=1000&&x<=8001){var w=(x-2000)/1000;var y=2451623.80984+365242.37404*w+0.05169*w*w-0.00411*w*w*w-0.00057*w*w*w*w}else{if(x>=-8000&&x<1000){var w=x/1000;var y=1721139.29189+365242.1374*w+0.06134*w*w+0.00111*w*w*w-0.00071*w*w*w*w}else{this.logs(0);return false}}return y};this.MeanJQJD=function(J){var J=this.intval(J);var K=new Array();var L=this.VE(J);var B=this.VE(J+1)-L;var y=2*Math.PI/24;var D=(L-2451545)/365250;var G=0.0167086342-0.0004203654*D-0.0000126734*D*D+1.444e-7*D*D*D-2e-10*D*D*D*D+3e-10*D*D*D*D*D;var H=J/1000;var w=111.25586939-17.0119934518333*H-0.044091890166673*H*H-0.000437356166661345*H*H*H+0.00000816716666602386*H*H*H*H;var M=w*2*Math.PI/360;var E=new Array(30);var C;for(C=1;C<=24;C++){var I=0;var x=y*(C-1)+M;if(x>Math.PI&&x<=3*Math.PI){x=2*Math.PI-x;I=1}if(x>3*Math.PI){x=4*Math.PI-x;I=2}var A=2*Math.atan((Math.sqrt((1-G)/(1+G))*Math.tan(x/2)));var z=(G*Math.sqrt(1-G*G)*Math.sin(x))/(1+G*Math.cos(x));var F=(A-z)*B/2/Math.PI;if(I==1){F=B-F}if(I==2){F=2*B-F}E[C]=F}for(C=1;C<=24;C++){K[C-1]=L+E[C]-E[1]}return K};this.Perturbation=function(z){var z=this.floatval(z);var C=new Array(485,203,199,182,156,136,77,74,70,58,52,50,45,44,29,18,17,16,14,12,12,12,9,8);var B=new Array(324.96,337.23,342.08,27.85,73.14,171.52,222.54,296.72,243.58,119.81,297.17,21.02,247.54,325.15,60.93,155.12,288.79,198.04,199.76,95.39,287.11,320.81,227.73,15.45);var A=new Array(1934.136,32964.467,20.186,445267.112,45036.886,22518.443,65928.934,3034.906,9037.513,33718.147,150.678,2281.226,29929.562,31555.956,4443.417,67555.328,4562.452,62894.029,31436.921,14577.848,31931.756,34777.259,1222.114,16859.074);var E=(z-2451545)/36525;var F=0;for(var y=0;y<=23;y++){F=F+C[y]*Math.cos(B[y]*2*Math.PI/360+A[y]*2*Math.PI/360*E)}var D=35999.373*E-2.47;var x=1+0.0334*Math.cos(D*2*Math.PI/360)+0.0007*Math.cos(2*D*2*Math.PI/360);return 0.00001*F/x};this.DeltaT=function(C,A){var C=this.intval(C);var A=this.intval(A);var w,x,z,B;B=C+(A-0.5)/12;if(B<=-500){w=(B-1820)/100;z=(-20+32*w*w)}else{if(B<500){w=B/100;z=(10583.6-1014.41*w+33.78311*w*w-5.952053*w*w*w-0.1798452*w*w*w*w+0.022174192*w*w*w*w*w+0.0090316521*w*w*w*w*w*w)}else{if(B<1600){w=(B-1000)/100;z=(1574.2-556.01*w+71.23472*w*w+0.319781*w*w*w-0.8503463*w*w*w*w-0.005050998*w*w*w*w*w+0.0083572073*w*w*w*w*w*w)}else{if(B<1700){x=B-1600;z=(120-0.9808*x-0.01532*x*x+x*x*x/7129)}else{if(B<1800){x=B-1700;z=(8.83+0.1603*x-0.0059285*x*x+0.00013336*x*x*x-x*x*x*x/1174000)}else{if(B<1860){x=B-1800;z=(13.72-0.332447*x+0.0068612*x*x+0.0041116*x*x*x-0.00037436*x*x*x*x+0.0000121272*x*x*x*x*x-1.699e-7*x*x*x*x*x*x+8.75e-10*x*x*x*x*x*x*x)}else{if(B<1900){x=B-1860;z=(7.62+0.5737*x-0.251754*x*x+0.01680668*x*x*x-0.0004473624*x*x*x*x+x*x*x*x*x/233174)}else{if(B<1920){x=B-1900;z=(-2.79+1.494119*x-0.0598939*x*x+0.0061966*x*x*x-0.000197*x*x*x*x)}else{if(B<1941){x=B-1920;z=(21.2+0.84493*x-0.0761*x*x+0.0020936*x*x*x)}else{if(B<1961){x=B-1950;z=(29.07+0.407*x-x*x/233+x*x*x/2547)}else{if(B<1986){x=B-1975;z=(45.45+1.067*x-x*x/260-x*x*x/718)}else{if(B<2005){x=B-2000;z=(63.86+0.3345*x-0.060374*x*x+0.0017275*x*x*x+0.000651814*x*x*x*x+0.00002373599*x*x*x*x*x)}else{if(B<2050){x=B-2000;z=(62.92+0.32217*x+0.005589*x*x)}else{if(B<2150){w=(B-1820)/100;z=(-20+32*w*w-0.5628*(2150-B))}else{w=(B-1820)/100;z=(-20+32*w*w)}}}}}}}}}}}}}}if(B<1955||B>=2005){z=z-(0.000012932*(B-1955)*(B-1955))}return z/60};this.GetAdjustedJQ=function(C,A){var C=this.intval(C);var A=A?true:false;var z=new Array();if(this.JQ[C]==undefined){var B=this.MeanJQJD(C);for(var x=0;x<24;x++){var w=this.Perturbation(B[x]);var y=this.DeltaT(C,Math.ceil(x/2)+3);z[x]=B[x]+w-y/60/24;z[x]=z[x]+8/24}this.JQ[C]=z}var z=this.JQ[C].slice(0);if(A==true){for(var x in this.jqXFu[C]){z[x]+=this.jqXFu[C][x]}}return z};this.GetZQsinceWinterSolstice=function(z){var z=this.intval(z);var y=new Array();var x=new Array(26);x=this.GetAdjustedJQ(z-1,true);y[0]=x[18];y[1]=x[20];y[2]=x[22];x=this.GetAdjustedJQ(z,true);for(var w=0;w<12;w++){y[w+3]=x[2*w]}x=this.GetAdjustedJQ(z+1,true);y[15]=x[0];return y};this.GetPureJQsinceSpring=function(z){var z=this.intval(z);var y=new Array();var x=this.GetAdjustedJQ(z-1,false);y[0]=x[21];y[1]=x[23];x=this.GetAdjustedJQ(z,false);for(var w=0;w<12;w++){y[w+2]=x[2*w+1]}x=this.GetAdjustedJQ(z+1,false);y[14]=x[1];return y};this.MeanNewMoon=function(x){var A,z,w;var x=this.floatval(x);var y=Math.floor((x-2451550.09765)/this.synmonth);w=2451550.09765+y*this.synmonth;A=(w-2451545)/36525;z=w+0.0001337*A*A-1.5e-7*A*A*A+7.3e-10*A*A*A*A;return y};this.TrueNewMoon=function(y){var I,C,A,z;var x,B,F,G,H;var J,E,D,w;var y=this.floatval(y);w=2451550.09765+y*this.synmonth;I=(w-2451545)/36525;C=I*I;A=C*I;z=A*I;J=w+0.0001337*C-1.5e-7*A+7.3e-10*z;x=2.5534+29.10535669*y-0.0000218*C-1.1e-7*A;B=201.5643+385.81693528*y+0.0107438*C+0.00001239*A-5.8e-8*z;F=160.7108+390.67050274*y-0.0016341*C-0.00000227*A+1.1e-8*z;G=124.7746-1.5637558*y+0.0020691*C+0.00000215*A;H=1-0.002516*I-0.0000074*C;E=-0.4072*Math.sin((Math.PI/180)*B);E+=0.17241*H*Math.sin((Math.PI/180)*x);E+=0.01608*Math.sin((Math.PI/180)*2*B);E+=0.01039*Math.sin((Math.PI/180)*2*F);E+=0.00739*H*Math.sin((Math.PI/180)*(B-x));E-=0.00514*H*Math.sin((Math.PI/180)*(B+x));E+=0.00208*H*H*Math.sin((Math.PI/180)*(2*x));E-=0.00111*Math.sin((Math.PI/180)*(B-2*F));E-=0.00057*Math.sin((Math.PI/180)*(B+2*F));E+=0.00056*H*Math.sin((Math.PI/180)*(2*B+x));E-=0.00042*Math.sin((Math.PI/180)*3*B);E+=0.00042*H*Math.sin((Math.PI/180)*(x+2*F));E+=0.00038*H*Math.sin((Math.PI/180)*(x-2*F));E-=0.00024*H*Math.sin((Math.PI/180)*(2*B-x));E-=0.00017*Math.sin((Math.PI/180)*G);E-=0.00007*Math.sin((Math.PI/180)*(B+2*x));E+=0.00004*Math.sin((Math.PI/180)*(2*B-2*F));E+=0.00004*Math.sin((Math.PI/180)*(3*x));E+=0.00003*Math.sin((Math.PI/180)*(B+x-2*F));E+=0.00003*Math.sin((Math.PI/180)*(2*B+2*F));E-=0.00003*Math.sin((Math.PI/180)*(B+x+2*F));E+=0.00003*Math.sin((Math.PI/180)*(B-x+2*F));E-=0.00002*Math.sin((Math.PI/180)*(B-x-2*F));E-=0.00002*Math.sin((Math.PI/180)*(3*B+x));E+=0.00002*Math.sin((Math.PI/180)*(4*B));D=0.000325*Math.sin((Math.PI/180)*(299.77+0.107408*y-0.009173*C));D+=0.000165*Math.sin((Math.PI/180)*(251.88+0.016321*y));D+=0.000164*Math.sin((Math.PI/180)*(251.83+26.651886*y));D+=0.000126*Math.sin((Math.PI/180)*(349.42+36.412478*y));D+=0.00011*Math.sin((Math.PI/180)*(84.66+18.206239*y));D+=0.000062*Math.sin((Math.PI/180)*(141.74+53.303771*y));D+=0.00006*Math.sin((Math.PI/180)*(207.14+2.453732*y));D+=0.000056*Math.sin((Math.PI/180)*(154.84+7.30686*y));D+=0.000047*Math.sin((Math.PI/180)*(34.52+27.261239*y));D+=0.000042*Math.sin((Math.PI/180)*(207.19+0.121824*y));D+=0.00004*Math.sin((Math.PI/180)*(291.34+1.844379*y));D+=0.000037*Math.sin((Math.PI/180)*(161.72+24.198154*y));D+=0.000035*Math.sin((Math.PI/180)*(239.56+25.513099*y));D+=0.000023*Math.sin((Math.PI/180)*(331.55+3.592518*y));return J+E+D};this.GetSMsinceWinterSolstice=function(E,A){var E=this.intval(E);var A=A?true:false;var w=new Array();var I,H=new Array(),B,y;var x,G,I;var D=this.GetAdjustedJQ(E-1,true);var F=D[18];x=this.Jdays(E-1,11,0,0);I=this.MeanNewMoon(x);for(B=0;B<=19;B++){y=I+B;H[B]=this.TrueNewMoon(y)+8/24;H[B]=H[B]-this.DeltaT(E,B-1)/1440}for(var z=0;z<=18;z++){if(Math.floor(H[z]+0.5)>Math.floor(F+0.5)){break}}var C=z;for(y=0;y<=15;y++){w[y]=H[C-1+y]}if(A==true){for(var y in this.smXFu[E]){w[y]+=this.smXFu[E][y]}}return w};this.GetZQandSMandLunarMonthCode=function(B){var B=this.intval(B);var A;var z=new Array();var x=this.GetZQsinceWinterSolstice(B);var y=this.GetSMsinceWinterSolstice(B,true);A=0;z[0]=0;if(Math.floor(x[12]+0.5)>=Math.floor(y[13]+0.5)){for(var w=1;w<=14;w++){if(Math.floor((y[w]+0.5)>Math.floor(x[w-1-A]+0.5)&&Math.floor(y[w+1]+0.5)<=Math.floor(x[w-A]+0.5))){z[w]=w-0.5;A=1}else{z[w]=w-A}}}else{for(var w=1;w<=12;w++){z[w]=w}for(var w=13;w<=14;w++){if(Math.floor((y[w]+0.5)>Math.floor(x[w-1-A]+0.5)&&Math.floor(y[w+1]+0.5)<=Math.floor(x[w-A]+0.5))){z[w]=w-0.5;A=1}else{z[w]=w-A}}}return z};this.Lunar2Solar=function(D,z,H,x){var D=this.intval(D);var z=this.intval(z);var H=this.intval(H);var x=this.boolval(x);var F=new Array(),E=new Array(),y;var C=new Array(),I,w,G;if(D<-7000||D>7000){this.logs(0);return false}if(D<-1000||D>3000){this.logs(1)}F=this.GetSMsinceWinterSolstice(D,true);E=this.GetZQandSMandLunarMonthCode(D);y=0;for(var A=1;A<=14;A++){if(E[A]-Math.floor(E[A])>0){y=Math.floor(E[A]+0.5);break}}G=z+2;for(var B=0;B<=14;B++){C[B]=Math.floor(F[B+1]+0.5)-Math.floor(F[B]+0.5)}I=0;if(G>=3&&G<=14){if(H>=1&&H<=30){if(x==true){if(y<3){I=1;this.logs(7)}else{if(y!=G){I=1;this.logs(8)}else{if(H<=C[G]){w=F[G]+H-1}else{I=1;this.logs(4)}}}}else{if(y==0){if(H<=C[G-1]){w=F[G-1]+H-1}else{I=1;this.logs(4)}}else{if(H<=C[G+(G>y)-1]){w=F[G+(G>y)-1]+H-1}else{I=1;this.logs(4)}}}if(I==0){}}else{I=1;this.logs(5)}}else{I=1;this.logs(6)}return I?false:this.Jtime(w).slice(0,3)};this.Solar2Lunar=function(D,A,H){var D=this.intval(D);var A=this.intval(A);var H=this.intval(H);var G=new Array(),F=new Array(),y;var E=0;if(D<-7000||D>7000){this.logs(0);return false}if(D<-1000||D>3000){this.logs(1)}if(this.ValidDate(D,A,H)===false){return false}G=this.GetSMsinceWinterSolstice(D,true);F=this.GetZQandSMandLunarMonthCode(D);var w=this.Jdays(D,A,H,12);if(Math.floor(w)<Math.floor(G[0]+0.5)){E=1;G=this.GetSMsinceWinterSolstice(D-1,true);F=this.GetZQandSMandLunarMonthCode(D-1)}for(var B=0;B<=14;B++){if(Math.floor(w)>=Math.floor(G[B]+0.5)&&Math.floor(w)<Math.floor(G[B+1]+0.5)){var C=B;break}}var I=Math.floor(w)-Math.floor(G[C]+0.5)+1;if(F[C]<2||E==1){var z=D-1}else{var z=D}if((F[C]-Math.floor(F[C]))*2+1==1){var x=false}else{var x=true}y=(Math.floor(F[C]+10)%12)+1;return Array(z,y,I,x)};this.GetWeek=function(z,y,w){var z=this.intval(z);var y=this.intval(y);var w=this.intval(w);var x=this.Jdays(z,y,w,12,0,0);if(x===false){return false}return(((Math.floor(x+1)%7))+7)%7};this.GetSolarDays=function(A,z){var A=this.intval(A);var z=this.intval(z);if(z<1||z>12){this.logs(13);return 0}if(A==1582&&z==10){return 21}var x=-(A%4==0);var w=((A%400==0)-(A%100==0))&&(A>1582);var y=x+w;return 30+((Math.abs(z-7.5)+0.5)%2)-(z==2)*(2+y)};this.GetLunarDays=function(C,y,w){var C=this.intval(C);var y=this.intval(y);var w=this.boolval(w);var E=new Array(),D=new Array(),x;var B=new Array(),H,G;if(C<-7000||C>7000){this.logs(0);return false}if(C<-1000||C>3000){this.logs(1)}E=this.GetSMsinceWinterSolstice(C,true);D=this.GetZQandSMandLunarMonthCode(C);x=0;for(var z=1;z<=14;z++){if(D[z]-Math.floor(D[z])>0){x=Math.floor(D[z]+0.5);break}}G=y+2;for(var A=0;A<=14;A++){B[A]=Math.floor(E[A+1]+0.5)-Math.floor(E[A]+0.5)}H=0;if(G>=3&&G<=14){if(w==true){if(x<3){H=1;this.logs(7)}else{if(x!=G){H=1;this.logs(8)}else{var F=B[G]}}}else{if(x==0){var F=B[G-1]}else{var F=B[G+(G>x)-1]}}}else{H=1;this.logs(6)}return H?false:F};this.GetRunyue=function(z){var z=this.intval(z);var y=this.GetZQandSMandLunarMonthCode(z);var x=0;for(var w=1;w<=14;w++){if(y[w]-Math.floor(y[w])>0){x=Math.floor(y[w]+0.5);break}}return Math.max(0,x-2)};this.GetXZ=function(C,z,D,y,w,F){var C=this.intval(C);var z=this.intval(z);var D=this.intval(D);var y=this.intval(y);var w=(w===undefined)?0:this.intval(w);var F=(F===undefined)?0:this.intval(F);if(this.ValidDate(C,z,D)===false){return false}var x=this.Jdays(C,z,D,y,w,F);if(x===false){return false}var B=this.GetZQsinceWinterSolstice(C);if(x<B[0]){var B=this.GetZQsinceWinterSolstice(C-1)}for(var A=0;A<=13;A++){if(x<B[A]){var E=(A+12-1)%12;break}}return E};this.GetGZ=function(D,M,O,y,F,H){var D=this.floatval(D);var M=this.floatval(M);var O=this.floatval(O);var y=this.floatval(y);var F=(F===undefined)?0:this.floatval(F);var H=(H===undefined)?0:this.floatval(H);if(F+H==0){H=10}if(this.ValidDate(D,M,O)===false){return false}var A=this.Jdays(D,M,O,y,F,H);if(A===false){return false}var G=new Array();var P=D;G=this.GetPureJQsinceSpring(D);if(A<G[0]){P=D-1;G=this.GetPureJQsinceSpring(P)}var z=new Array();var C=new Array();var B=((P+4712+24)%60+60)%60;z[0]=B%10;C[0]=B%12;for(var J=0;J<=13;J++){if(G[J]>=A){var x=J-1;break}}var Q=((P+4712)*12+(x)+60)%60;var K=(Q+50)%60;z[1]=K%10;C[1]=K%12;var E=A+0.5;var I=((E-Math.floor(E))*86400)+3600;var w=Math.floor(E)+I/86400;var L=(Math.floor(w+49)%60+60)%60;z[2]=L%10;C[2]=L%12;if(this.zwz&&(y>=23)){z[2]=(z[2]+10-1)%10;C[2]=(C[2]+12-1)%12}var N=w*12;var R=(Math.floor(N+48)%60+60)%60;z[3]=R%10;C[3]=R%12;return Array(z,C)};this.MGZ=function(z){var z=this.intval(z);var A=new Array();var w=2+12*(z%10);for(var x=0;x<=11;x++){var y=(x+w)%60;A[y]=this.gz[y]}return A};this.HGZ=function(x){var x=this.intval(x);var A=new Array();var w=12*(x%10);for(var y=0;y<=(this.zwz?12:11);y++){var z=(y+w)%60;A[z]=this.gz[z]+(y==12?"+":"")}return A};this.GZ=function(x,w){var x=this.intval(x);var w=this.intval(w);if(x<0||x>59){this.logs(3,11);return false}if(w<0||w>59){this.logs(3,12);return false}if((x%2)!=(w%2)){this.logs(3,13);return false}return((10+x-w)%10)/2*12+w};this.gz2gl=function(F,Q,R,V,N,H){var F=this.intval(F);var Q=this.intval(Q);var R=this.intval(R);var V=this.intval(V);var N=this.intval(N);var H=this.intval(H);if(F<0||F>=60){this.logs(3,0);return false}if(Q<0||Q>=60){this.logs(3,1);return false}if(R<0||R>=60){this.logs(3,2);return false}if(V<0||V>=60){this.logs(3,3);return false}if(!(Q in this.MGZ(F))){this.logs(2,0);return false}if(!(V in this.HGZ(R))){this.logs(2,1);return false}var I=this.HGZ(R);if(this.zwz&&(I[V].substr(-1)=="+")){R=(R+1)%60}var P=N+H*60;if(N<-1000||P>3000){this.logs(1)}var C=new Array();for(var M=0;M<=H-1;M++){var A=N+M*60;var O=(A+56)%60;var y=(F+60-O)%60;var z=A+y;var S=this.GetPureJQsinceSpring(z);var E=(Q+60-2)%12;var x=S[E];var D=S[E+1];var G=(Math.floor(x)+49)%60;var U=(R+60-G)%60;var T=Math.floor(x+U);var B=V%12;var K=T+(B*2-13)/24;var J=T+(B*2-11)/24;if(J<x||K>D){}else{if(K>x&&J<D){var L=K;var w=J}if(K<x&&J>x){var L=x;var w=J}if(K<D&&J>D){var L=K;var w=D}C.push([this.Jtime(L),this.Jtime(w)])}}return C};this.fatemaps=function(H,D,C,F,B,x,I,E,z){var H=this.intval(H)?1:0;var D=this.intval(D);var C=this.intval(C);var F=this.intval(F);var B=this.intval(B);var x=(x===undefined)?0:this.intval(x);var I=(I===undefined)?0:this.intval(I);if(D<-1000||D>3000){this.logs(1)}var y=this.Jdays(D,C,F,B,x,I);if(y===false){return false}var A=new Array();if(E!==undefined){A.pty=y+(this.floatval(E)-this.J)*4*60/86400;A.pty=this.Jtime(A.pty);y=this.zty(y,E,z);A.zty=this.Jtime(y)}var [D,C,F,B,x,I]=this.Jtime(y);var ta=365.24244475;var nwx=new Array(0,0,0,0,0);var nyy=new Array(0,0);var szs=new Array(1,6,10,9,10,9,7,0,4,3);var ty=D;var jr=this.GetPureJQsinceSpring(ty);if(y<jr[0]){ty=D-1;jr=this.GetPureJQsinceSpring(ty)}var [tg,G]=this.GetGZ(D,C,F,B,x,I);var yytg=new Array();var yydz=new Array();var ewxtg=new Array();var ewxdz=new Array();for(var k=0;k<=3;k++){yytg[k]=tg[k]%2;nyy[yytg[k]]=nyy[yytg[k]]+1;yydz[k]=G[k]%2;nyy[yydz[k]]=nyy[yydz[k]]+1;ewxtg[k]=this.wxtg[tg[k]];nwx[ewxtg[k]]=nwx[ewxtg[k]]+1;ewxdz[k]=this.wxdz[G[k]];nwx[ewxdz[k]]=nwx[ewxdz[k]]+1}A.nyy=nyy;A.nwx=nwx;A.yytg=yytg;A.yydz=yydz;A.ewxtg=ewxtg;A.ewxdz=ewxdz;var bzcg=new Array();var wxcg=new Array();var yycg=new Array();var bctg=new Array();for(var i=0;i<=3;i++){wxcg[i]=new Array();yycg[i]=new Array();for(var j=0;j<=2;j++){var nzcg=this.zcg[G[i]][j];if(nzcg>=0){bctg[3*i+j]=this.ctg[nzcg];bzcg[3*i+j]=this.sss[this.dgs[nzcg][tg[2]]];wxcg[i][j]=this.wxtg[nzcg];yycg[i][j]=nzcg%2}else{bctg[3*i+j]="";bzcg[3*i+j]=""}}}A.bctg=bctg;A.bzcg=bzcg;A.wxcg=wxcg;A.yycg=yycg;for(var i=0;i<=14;i++){if(jr[i]>y){var ord=i-1;break}}var xf=y-jr[ord];var yf=jr[ord+1]-y;if(((H==0)&&(yytg[0]==0))||((H==1)&&(yytg[0]==1))){var zf=ta*10*(yf/(yf+xf));var forward=0}else{var zf=ta*10*(xf/(yf+xf));var forward=1}var qyt=y+zf;var jt=this.Jtime(qyt);var qyy=jt[0];A.qyy=qyy;A.qyy_desc="出生后"+this.intval(zf/ta)+"年"+this.intval(zf%ta/(ta/12))+"个月"+this.intval(zf%ta%(ta/12))+"天起运";var qjr=this.GetPureJQsinceSpring(qyy);if(qyt>=qjr[0]){var jqyy=qyy}else{var jqyy=qyy-1}var jtd=((jqyy+4712+24)%10+10)%10;jtd=this.ctg[((jqyy+4712+24)%10+10)%10]+" "+this.ctg[((jqyy+4712+24+5)%10+10)%10];A.qyy_desc2="每逢 "+jtd+" 年"+jt[1]+"月"+jt[2]+"日交大運";var qage=jqyy-ty;A.dy=new Array();var zqage=new Array();var zboz=new Array();var zfman=new Array();var zfmbn=new Array();var zfma=new Array();var zfmb=new Array();var nzs=new Array();var mgz=((10+tg[1]-G[1])%10)/2*12+G[1];for(var k=0;k<=8;k++){if(A.dy[k]===undefined){A.dy[k]=new Array()}A.dy[k]["zqage"]=zqage[k]=qage+1+k*10;A.dy[k]["zboz"]=zboz[k]=qage+1+k*10+9;A.dy[k]["syear"]=qyy+k*10;A.dy[k]["eyear"]=qyy+k*10+9;A.dy[k]["zfman"]=zfman[k]=(mgz+60+Math.pow(-1,forward)*(k+1))%10;A.dy[k]["zfmbn"]=zfmbn[k]=(mgz+60+Math.pow(-1,forward)*(k+1))%12;A.dy[k]["zfma"]=zfma[k]=this.ctg[zfman[k]];A.dy[k]["zfmb"]=zfmb[k]=this.cdz[zfmbn[k]];A.dy[k]["nzs"]=nzs[k]=(24+szs[tg[2]]+Math.pow(-1,tg[2])*(zfmbn[0]+Math.pow(-1,forward)*k))%12;A.dy[k]["nzsc"]=this.czs[nzs[k]]}var lyean=new Array();var lyebn=new Array();var lye=new Array();for(var j=0;j<=89;j++){var k=this.intval(j/10);var i=j%10;if(A.dy[k]["ly"]===undefined){A.dy[k]["ly"]=new Array()}if(A.dy[k]["ly"][i]===undefined){A.dy[k]["ly"][i]=new Array()}A.dy[k]["ly"][i]["age"]=j+qage+1;A.dy[k]["ly"][i]["year"]=j+qage+ty;A.dy[k]["ly"][i]["lyean"]=lyean[j]=(tg[0]+j+qage)%10;A.dy[k]["ly"][i]["lyebn"]=lyebn[j]=(G[0]+j+qage)%12;A.dy[k]["ly"][i]["lye"]=lye[j]=this.ctg[lyean[j]]+this.cdz[lyebn[j]]}var zr=this.GetZQsinceWinterSolstice(D);if(y<zr[0]){var zr=this.GetZQsinceWinterSolstice(D-1)}for(var i=0;i<=13;i++){if(y<zr[i]){var xz=(i+12-1)%12;break}}A.mz=this.mz[H];A.xb=this.xb[H];A.gl=[D,C,F];A.nl=this.Solar2Lunar(D,C,F);A.tg=tg;A.dz=G;A.sz=new Array();A.ctg=new Array();A.cdz=new Array();for(var i=0;i<=3;i++){A.sz[i]=this.ctg[tg[i]]+this.cdz[G[i]];A.ctg[i]=this.ctg[tg[i]];A.cdz[i]=this.cdz[G[i]]}A.sx=this.csx[G[0]];A.xz=this.cxz[xz];A.cyy=this.cyy[yytg[2]];return A}}window.p=new paipan();
